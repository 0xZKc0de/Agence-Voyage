<div class="circuits-page" [class.sidebar-active]="hasActiveChild">
  <div class="circuits-header">
    <h2 class="circuits-title">Nos Circuits</h2>

    <div class="circuits-header-actions">
      <input
        type="text"
        placeholder="Rechercher un circuit..."
        [(ngModel)]="searchTerm"
        (ngModelChange)="filterTrips()"
        class="search-input"
      />

      <div class="filter-options">
        <select
          class="filter-select"
          [(ngModel)]="selectedDestination"
          (ngModelChange)="filterTrips()"
        >
          <option value="">Toutes destinations</option>
          <option *ngFor="let destination of destinations" [value]="destination">
            {{ destination }}
          </option>
        </select>

        <select
          class="filter-select"
          [(ngModel)]="selectedDuration"
          (ngModelChange)="filterTrips()"
        >
          <option value="">Toutes durÃ©es</option>
          <option *ngFor="let duration of durations" [value]="duration">
            {{ duration }} jours{{ duration === '7' ? ' et plus' : '' }}
          </option>
        </select>

        <button
          class="btn-clear-filters"
          (click)="clearFilters()"
          *ngIf="selectedDestination || selectedDuration || searchTerm"
        >
          Effacer les filtres
        </button>
      </div>
    </div>
  </div>

  <div class="circuits-container">
    <div class="loading-overlay" *ngIf="isLoading">
      <div class="spinner"></div>
      <p>Chargement des circuits...</p>
    </div>

    <div class="circuits-grid" *ngIf="!isLoading">
      <div
        class="circuit-card"
        *ngFor="let circuit of filteredCircuits"
        (click)="selectCircuit(circuit)"
      >
        <div class="circuit-image">
          <img [src]="circuit.imageUrl" [alt]="circuit.distination">
          <div class="circuit-price-tag">{{ circuit.prix | currency:'MAD ' }}</div>
        </div>

        <div class="circuit-content">
          <div class="circuit-info-header">
            <span class="circuit-dest">ğŸ“ {{ circuit.distination }}</span>
            <span class="circuit-duration">â±ï¸ {{ circuit.duration }} jours</span>
          </div>

          <p class="circuit-description">{{ circuit.description }}</p>

          <div class="circuit-details">
            <div class="circuit-date">
              ğŸ—“ï¸ {{ circuit.dateDepart | date:'dd/MM/yyyy' }}
            </div>
            <div class="circuit-places">
              ğŸ·ï¸ {{ circuit.nb_places }} places disponibles
            </div>
          </div>

          <div class="circuit-actions">
            <button class="btn-details" (click)="selectCircuit(circuit); $event.stopPropagation()">
              Voir dÃ©tails
            </button>
            <button class="btn-reserve"
                    (click)="reserveCircuit(circuit); $event.stopPropagation()"
                    [disabled]="circuit.nb_places === 0">
              RÃ©server
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="no-circuits" *ngIf="!isLoading && filteredCircuits.length === 0">
      <div class="no-circuits-content">
        <div class="no-circuits-icon">ğŸŒ</div>
        <h3>Aucun circuit trouvÃ©</h3>
        <p>Essayez avec d'autres critÃ¨res de recherche</p>
      </div>
    </div>
  </div>

  <div class="circuits-sidebar-outlet" *ngIf="hasActiveChild">
    <router-outlet></router-outlet>
  </div>
</div>
