<div class="reservations-page">
  <!-- HEADER -->
  <div class="reservations-header">
    <div class="header-left">
      <h2>Mes R√©servations</h2>
      <p>G√©rez toutes vos r√©servations de voyage</p>
    </div>
    
    <div class="header-right">
      <button class="btn-new-reservation" routerLink="/client/circuits">
        + Nouvelle r√©servation
      </button>
    </div>
  </div>

  <!-- FILTERS -->
  <div class="filters-section">
    <div class="search-box">
      <input
        type="text"
        placeholder="Rechercher par client, circuit..."
        [(ngModel)]="searchTerm"
        (ngModelChange)="filterReservations()"
        class="search-input"
      />
    </div>
    
    <div class="filter-options">
      <select 
        class="filter-select"
        [(ngModel)]="statusFilter"
        (ngModelChange)="filterReservations()"
      >
        <option value="">Tous les statuts</option>
        <option value="EN_ATTENTE">En attente</option>
        <option value="CONFIRMEE">Confirm√©es</option>
        <option value="ANNULEE">Annul√©es</option>
      </select>
      
      <button 
        class="btn-clear-filters" 
        (click)="clearFilters()"
        *ngIf="searchTerm || statusFilter"
      >
        Effacer les filtres
      </button>
    </div>
  </div>

  <!-- STATS -->
  <div class="reservations-stats">
    <div class="stat-card">
      <div class="stat-icon">üìã</div>
      <div class="stat-info">
        <span class="stat-label">Total</span>
        <span class="stat-number">{{ totalReservations }}</span>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">‚úÖ</div>
      <div class="stat-info">
        <span class="stat-label">Confirm√©es</span>
        <span class="stat-number">{{ confirmedReservations }}</span>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">‚è±Ô∏è</div>
      <div class="stat-info">
        <span class="stat-label">En attente</span>
        <span class="stat-number">{{ pendingReservations }}</span>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">üí∞</div>
      <div class="stat-info">
        <span class="stat-label">Total d√©pens√©</span>
        <span class="stat-number">{{ totalSpent | currency:'MAD ' }}</span>
      </div>
    </div>
  </div>

  <!-- LOADING -->
  <div class="loading-spinner" *ngIf="isLoading">
    Chargement des r√©servations...
  </div>

  <!-- RESERVATIONS TABLE -->
  <div class="reservations-container" *ngIf="!isLoading">
    <div class="results-count">
      {{ filteredReservations.length }} r√©servation{{ filteredReservations.length > 1 ? 's' : '' }} trouv√©e{{ filteredReservations.length > 1 ? 's' : '' }}
    </div>
    
    <div class="table-container" *ngIf="filteredReservations.length > 0">
      <table class="reservations-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Date r√©servation</th>
            <th>Date d√©part</th>
            <th>Personnes</th>
            <th>Client</th>
            <th>Circuit</th>
            <th>Prix total</th>
            <th>Statut</th>
            <th>Paiement</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let reservation of filteredReservations">
            <td class="reservation-id">#{{ reservation.id }}</td>
            <td>{{ reservation.dateReservation | date:'dd/MM/yyyy' }}</td>
            <td>{{ reservation.dateDepart | date:'dd/MM/yyyy' }}</td>
            <td>{{ reservation.participants }}</td>
            <td>
              <div class="client-info">
                <strong>{{ reservation.clientNom }}</strong>
                <small>{{ reservation.clientEmail }}</small>
              </div>
            </td>
            <td>
              <div class="circuit-info">
                <strong>{{ reservation.circuitNom }}</strong>
                <small>üìç {{ reservation.circuitDestination }}</small>
              </div>
            </td>
            <td class="price">{{ reservation.prixTotal | currency:'MAD ' }}</td>
            <td>
              <span class="badge" [class]="getStatusBadgeClass(reservation.statut)">
                {{ getStatusText(reservation.statut) }}
              </span>
            </td>
            <td>
              <span class="badge" [class]="getPaymentBadgeClass(reservation.paiementStatut || 'EN_ATTENTE')">
                {{ getPaymentText(reservation.paiementStatut || 'EN_ATTENTE') }}
              </span>
            </td>
            <td class="actions">
              <button 
                class="btn-cancel" 
                (click)="cancelReservation(reservation)"
                *ngIf="reservation.statut !== 'ANNULEE'"
              >
                ‚ùå Annuler
              </button>
              <button 
                class="btn-pay" 
                (click)="processPayment(reservation)"
                *ngIf="reservation.statut === 'EN_ATTENTE'"
                >
                üí≥ Payer
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- NO RESULTS -->
    <div class="no-reservations" *ngIf="filteredReservations.length === 0 && !isLoading">
      <div class="empty-state">
        <div class="empty-icon">üìã</div>
        <h3>Aucune r√©servation trouv√©e</h3>
        <p *ngIf="searchTerm || statusFilter">
          Aucune r√©servation ne correspond √† vos crit√®res de recherche.
        </p>
        <p *ngIf="!searchTerm && !statusFilter">
          Vous n'avez pas encore de r√©servations.
        </p>
        <button class="btn-new-reservation" routerLink="/client/circuits">
          + Faire une nouvelle r√©servation
        </button>
      </div>
    </div>
  </div>
</div>